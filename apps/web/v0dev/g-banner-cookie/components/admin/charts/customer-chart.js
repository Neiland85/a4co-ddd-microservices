'use client';
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = CustomerChart;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const recharts_1 = require("recharts");
const card_1 = require("@/components/ui/card");
const button_1 = require("@/components/ui/button");
const badge_1 = require("@/components/ui/badge");
const lucide_react_1 = require("lucide-react");
const utils_1 = require("@/lib/utils");
const CustomTooltip = ({ active, payload, label }) => {
    if (active && payload?.length) {
        return ((0, jsx_runtime_1.jsxs)("div", { className: "shadow-natural-lg rounded-lg border border-gray-200 bg-white p-4", children: [(0, jsx_runtime_1.jsx)("p", { className: "mb-2 font-medium text-gray-900", children: label }), payload.map((entry, index) => ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center space-x-2", children: [(0, jsx_runtime_1.jsx)("div", { className: "h-3 w-3 rounded-full", style: { backgroundColor: entry.color } }), (0, jsx_runtime_1.jsxs)("span", { className: "text-sm text-gray-600", children: [entry.name, ":"] }), (0, jsx_runtime_1.jsx)("span", { className: "text-sm font-semibold text-gray-900", children: entry.value })] }, index)))] }));
    }
    return null;
};
function CustomerChart({ data, className }) {
    const [chartType, setChartType] = (0, react_1.useState)('composed');
    const totalNewCustomers = data.reduce((sum, item) => sum + item.newCustomers, 0);
    const totalReturningCustomers = data.reduce((sum, item) => sum + item.returningCustomers, 0);
    const totalCustomers = data.reduce((sum, item) => sum + item.totalCustomers, 0);
    const retentionRate = totalCustomers > 0 ? (totalReturningCustomers / totalCustomers) * 100 : 0;
    return ((0, jsx_runtime_1.jsxs)(card_1.Card, { className: (0, utils_1.cn)('shadow-natural-lg hover:shadow-natural-xl transition-all duration-300', className), children: [(0, jsx_runtime_1.jsxs)(card_1.CardHeader, { children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsxs)(card_1.CardTitle, { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Users, { className: "text-a4co-olive-600 mr-2 h-5 w-5" }), "An\u00E1lisis de Clientes"] }), (0, jsx_runtime_1.jsx)(card_1.CardDescription, { children: "Evoluci\u00F3n de clientes nuevos y recurrentes" })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center space-x-2", children: [(0, jsx_runtime_1.jsx)(button_1.Button, { onClick: () => setChartType('composed'), className: (0, utils_1.cn)('transition-all duration-300 hover:scale-105', chartType === 'composed'
                                            ? 'bg-a4co-olive-600 text-white'
                                            : 'border border-gray-300 bg-transparent text-gray-700 hover:bg-gray-50'), children: "Combinado" }), (0, jsx_runtime_1.jsx)(button_1.Button, { onClick: () => setChartType('bar'), className: (0, utils_1.cn)('transition-all duration-300 hover:scale-105', chartType === 'bar'
                                            ? 'bg-a4co-olive-600 text-white'
                                            : 'border border-gray-300 bg-transparent text-gray-700 hover:bg-gray-50'), children: "Barras" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "mt-4 grid grid-cols-1 gap-4 md:grid-cols-4", children: [(0, jsx_runtime_1.jsx)("div", { className: "rounded-lg border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-sm font-medium text-gray-600", children: "Clientes Nuevos" }), (0, jsx_runtime_1.jsx)("p", { className: "text-2xl font-bold text-blue-700", children: totalNewCustomers })] }), (0, jsx_runtime_1.jsx)(lucide_react_1.UserPlus, { className: "h-8 w-8 text-blue-600" })] }) }), (0, jsx_runtime_1.jsx)("div", { className: "rounded-lg border border-green-200 bg-gradient-to-r from-green-50 to-emerald-50 p-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-sm font-medium text-gray-600", children: "Clientes Recurrentes" }), (0, jsx_runtime_1.jsx)("p", { className: "text-2xl font-bold text-green-700", children: totalReturningCustomers })] }), (0, jsx_runtime_1.jsx)(lucide_react_1.UserCheck, { className: "h-8 w-8 text-green-600" })] }) }), (0, jsx_runtime_1.jsx)("div", { className: "from-a4co-olive-50 to-a4co-clay-50 border-a4co-olive-200 rounded-lg border bg-gradient-to-r p-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-sm font-medium text-gray-600", children: "Total Clientes" }), (0, jsx_runtime_1.jsx)("p", { className: "text-a4co-olive-700 text-2xl font-bold", children: totalCustomers })] }), (0, jsx_runtime_1.jsx)(lucide_react_1.Users, { className: "text-a4co-olive-600 h-8 w-8" })] }) }), (0, jsx_runtime_1.jsx)("div", { className: "rounded-lg border border-purple-200 bg-gradient-to-r from-purple-50 to-pink-50 p-4", children: (0, jsx_runtime_1.jsx)("div", { className: "flex items-center justify-between", children: (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-sm font-medium text-gray-600", children: "Tasa de Retenci\u00F3n" }), (0, jsx_runtime_1.jsxs)("p", { className: "flex items-center text-2xl font-bold text-purple-700", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.TrendingUp, { className: "mr-1 h-5 w-5" }), retentionRate.toFixed(1), "%"] })] }) }) })] })] }), (0, jsx_runtime_1.jsxs)(card_1.CardContent, { children: [(0, jsx_runtime_1.jsx)("div", { className: "h-80", children: (0, jsx_runtime_1.jsx)(recharts_1.ResponsiveContainer, { width: "100%", height: "100%", children: (0, jsx_runtime_1.jsxs)(recharts_1.ComposedChart, { data: data, children: [(0, jsx_runtime_1.jsx)(recharts_1.CartesianGrid, { strokeDasharray: "3 3", stroke: "#f0f0f0" }), (0, jsx_runtime_1.jsx)(recharts_1.XAxis, { dataKey: "month", stroke: "#666", fontSize: 12, tickLine: false, axisLine: false }), (0, jsx_runtime_1.jsx)(recharts_1.YAxis, { stroke: "#666", fontSize: 12, tickLine: false, axisLine: false }), (0, jsx_runtime_1.jsx)(recharts_1.Tooltip, { content: (0, jsx_runtime_1.jsx)(CustomTooltip, {}) }), (0, jsx_runtime_1.jsx)(recharts_1.Legend, {}), chartType === 'composed' ? ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(recharts_1.Bar, { dataKey: "newCustomers", name: "Clientes Nuevos", fill: "#3b82f6", radius: [2, 2, 0, 0] }), (0, jsx_runtime_1.jsx)(recharts_1.Bar, { dataKey: "returningCustomers", name: "Clientes Recurrentes", fill: "#10b981", radius: [2, 2, 0, 0] }), (0, jsx_runtime_1.jsx)(recharts_1.Line, { type: "monotone", dataKey: "totalCustomers", name: "Total Clientes", stroke: "#8a9b73", strokeWidth: 3, dot: { fill: '#8a9b73', strokeWidth: 2, r: 4 }, activeDot: {
                                                    r: 6,
                                                    fill: '#8a9b73',
                                                    strokeWidth: 2,
                                                    stroke: '#fff',
                                                    style: { filter: 'drop-shadow(0 2px 4px rgba(0,0,0,0.1))' },
                                                } })] })) : ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(recharts_1.Bar, { dataKey: "newCustomers", name: "Clientes Nuevos", fill: "#3b82f6", radius: [2, 2, 0, 0] }), (0, jsx_runtime_1.jsx)(recharts_1.Bar, { dataKey: "returningCustomers", name: "Clientes Recurrentes", fill: "#10b981", radius: [2, 2, 0, 0] })] }))] }) }) }), (0, jsx_runtime_1.jsxs)("div", { className: "mt-6 grid grid-cols-1 gap-4 md:grid-cols-2", children: [(0, jsx_runtime_1.jsxs)("div", { className: "rounded-lg bg-gray-50 p-4", children: [(0, jsx_runtime_1.jsx)("h4", { className: "mb-2 font-medium text-gray-900", children: "Tendencias de Adquisici\u00F3n" }), (0, jsx_runtime_1.jsx)("div", { className: "space-y-2", children: data.slice(-3).map((month, index) => ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsx)("span", { className: "text-sm text-gray-600", children: month.month }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center space-x-2", children: [(0, jsx_runtime_1.jsxs)(badge_1.Badge, { variant: "outline", className: "border-blue-200 bg-blue-50 text-blue-700", children: ["+", month.newCustomers] }), (0, jsx_runtime_1.jsx)("span", { className: "text-sm text-gray-500", children: "nuevos" })] })] }, month.month))) })] }), (0, jsx_runtime_1.jsxs)("div", { className: "rounded-lg bg-gray-50 p-4", children: [(0, jsx_runtime_1.jsx)("h4", { className: "mb-2 font-medium text-gray-900", children: "Retenci\u00F3n por Mes" }), (0, jsx_runtime_1.jsx)("div", { className: "space-y-2", children: data.slice(-3).map((month, index) => {
                                            const monthRetention = month.totalCustomers > 0
                                                ? (month.returningCustomers / month.totalCustomers) * 100
                                                : 0;
                                            return ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsx)("span", { className: "text-sm text-gray-600", children: month.month }), (0, jsx_runtime_1.jsx)("div", { className: "flex items-center space-x-2", children: (0, jsx_runtime_1.jsxs)(badge_1.Badge, { variant: "outline", className: (0, utils_1.cn)('border-green-200', monthRetention >= 50
                                                                ? 'bg-green-50 text-green-700'
                                                                : 'bg-yellow-50 text-yellow-700'), children: [monthRetention.toFixed(1), "%"] }) })] }, month.month));
                                        }) })] })] })] })] }));
}
//# sourceMappingURL=customer-chart.js.map