title = "gitleaks config"

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey)([\'\"]?)\s*[:=]\s*[\'\"]?([a-zA-Z0-9_-]{20,})[\'\"]?'''
secretGroup = 3
entropy = 3.5

[[rules]]
id = "aws-access-key"
description = "AWS Access Key"
regex = '''(AKIA[0-9A-Z]{16})'''
secretGroup = 1

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Key"
regex = '''(?i)aws[_-]?secret[_-]?key[\'\"]?[\s]*[:=][\s]*[\'\"]?([a-zA-Z0-9/+=]{40})[\'\"]?'''
secretGroup = 1

[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[A-Za-z0-9-_]*\.eyJ[A-Za-z0-9-_]*\.([A-Za-z0-9-_]*)'''
secretGroup = 1

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN [A-Z ]*PRIVATE KEY-----'''
secretGroup = 0

[[rules]]
id = "ssh-private-key"
description = "SSH Private Key"
regex = '''-----BEGIN OPENSSH PRIVATE KEY-----'''
secretGroup = 0

[[rules]]
id = "database-password"
description = "Database Password"
regex = '''(?i)(password|passwd|pwd)[\'\"]?[\s]*[:=][\s]*[\'\"]?([a-zA-Z0-9!@#$%^&*()_+-=]{8,})[\'\"]?'''
secretGroup = 2
entropy = 3.0

[[rules]]
id = "stripe-secret-key"
description = "Stripe Secret Key"
regex = '''sk_(test|live)_[0-9a-zA-Z]{24}'''
secretGroup = 0

[[rules]]
id = "github-token"
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''
secretGroup = 0

[[rules]]
id = "slack-token"
description = "Slack Token"
regex = '''xox[baprs]-[0-9]{12}-[0-9]{12}-[0-9a-zA-Z]{24}'''
secretGroup = 0

# Allow list for false positives
[allowlist]
description = "Allow list for false positives"
paths = [
    '''node_modules/''',
    '''\.git/''',
    '''dist/''',
    '''build/''',
    '''coverage/''',
    '''\.env\.example''',
    '''\.env\.local\.example''',
    '''test.*''',
    '''spec.*''',
    '''mock.*''',
    '''fixture.*'''
]

# Allow specific regex patterns that are safe
regexes = [
    '''AKIAIOSFODNN7EXAMPLE''',  # AWS example key
    '''sk_test_your_key_here''',  # Stripe test placeholder
    '''pk_test_your_key_here''',  # Stripe test placeholder
    '''CHANGE_THIS_SECRET_KEY''',  # Generic placeholder
    '''dev-secret-key''',  # Development placeholder
    '''your-app-password''',  # Email placeholder
    '''your-webhook-secret''',  # Webhook placeholder
    '''your-email@gmail\.com''',  # Email placeholder
    '''yourorg/ocr-validator''',  # Docker placeholder
    '''registry\.example\.com''',  # Registry placeholder
]