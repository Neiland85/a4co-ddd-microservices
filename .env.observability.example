# ================================================================
# A4CO Observability Stack Environment Variables
# PR4: Observability Event-Driven Infrastructure
# ================================================================
#
# Copy this file to .env.observability and configure your values
# Usage: docker-compose --env-file .env.observability -f docker-compose.observability.yml up -d
#
# ================================================================

# ================================================================
# ENVIRONMENT
# ================================================================
ENVIRONMENT=development
PROJECT_NAME=a4co-ddd-microservices

# ================================================================
# GRAFANA CONFIGURATION
# ================================================================
GF_ADMIN_USER=admin
GF_ADMIN_PASSWORD=admin
# IMPORTANT: Change this in production!

# Grafana server configuration
GF_SERVER_ROOT_URL=http://localhost:3000
GF_SERVER_DOMAIN=localhost

# Grafana security
GF_SECURITY_ADMIN_USER=${GF_ADMIN_USER}
GF_SECURITY_ADMIN_PASSWORD=${GF_ADMIN_PASSWORD}
GF_USERS_ALLOW_SIGN_UP=false
GF_USERS_ALLOW_ORG_CREATE=false
GF_AUTH_ANONYMOUS_ENABLED=false

# Grafana SMTP (for email notifications)
# GF_SMTP_ENABLED=false
# GF_SMTP_HOST=smtp.gmail.com:587
# GF_SMTP_USER=alerts@a4co.com
# GF_SMTP_PASSWORD=your_smtp_password
# GF_SMTP_FROM_ADDRESS=alerts@a4co.com
# GF_SMTP_FROM_NAME=A4CO Alerts

# ================================================================
# PROMETHEUS CONFIGURATION
# ================================================================
PROMETHEUS_RETENTION_TIME=30d
PROMETHEUS_RETENTION_SIZE=10GB

# External labels
PROMETHEUS_CLUSTER=a4co-prod
PROMETHEUS_ENVIRONMENT=${ENVIRONMENT}

# ================================================================
# LOKI CONFIGURATION
# ================================================================
LOKI_RETENTION_PERIOD=744h  # 31 days
LOKI_MAX_LINE_SIZE=262144   # 256KB
LOKI_INGESTION_RATE_MB=100

# ================================================================
# ALERTMANAGER CONFIGURATION
# ================================================================

# Slack webhook for alerts (optional)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
# SLACK_CHANNEL_CRITICAL=#alerts-critical
# SLACK_CHANNEL_WARNING=#alerts-warning
# SLACK_CHANNEL_INFO=#alerts-info

# Email configuration (optional)
# SMTP_SMARTHOST=smtp.gmail.com:587
# SMTP_FROM=alerts@a4co.com
# SMTP_AUTH_USERNAME=alerts@a4co.com
# SMTP_AUTH_PASSWORD=your_smtp_password
# ALERT_EMAIL_TO=team@a4co.com

# PagerDuty integration (optional)
# PAGERDUTY_SERVICE_KEY=your_pagerduty_service_key
# PAGERDUTY_URL=https://events.pagerduty.com/v2/enqueue

# Webhook URLs for custom integrations (optional)
# WEBHOOK_URL=http://your-webhook-service:5001/webhook
# WEBHOOK_CRITICAL_URL=http://your-webhook-service:5001/webhook/critical

# ================================================================
# NETWORK CONFIGURATION
# ================================================================
# If running with existing microservices, ensure network compatibility
MICROSERVICES_NETWORK_NAME=a4co-ddd-microservices_microservices-net

# ================================================================
# STORAGE CONFIGURATION
# ================================================================
# Docker volume configuration (optional - defaults to docker volumes)
# PROMETHEUS_DATA_PATH=/opt/observability/prometheus
# GRAFANA_DATA_PATH=/opt/observability/grafana
# LOKI_DATA_PATH=/opt/observability/loki
# ALERTMANAGER_DATA_PATH=/opt/observability/alertmanager

# ================================================================
# NATS CONFIGURATION
# ================================================================
# NATS server connection (if different from default)
NATS_MONITORING_URL=http://nats:8222

# ================================================================
# LOG LEVELS
# ================================================================
PROMETHEUS_LOG_LEVEL=info
GRAFANA_LOG_LEVEL=info
LOKI_LOG_LEVEL=info
PROMTAIL_LOG_LEVEL=info
ALERTMANAGER_LOG_LEVEL=info

# ================================================================
# FEATURE FLAGS
# ================================================================
# Enable/disable specific features
ENABLE_ALERTING=true
ENABLE_RECORDING_RULES=true
ENABLE_JAEGER_INTEGRATION=false  # For PR6
ENABLE_TEMPO_INTEGRATION=false   # For PR6

# ================================================================
# PERFORMANCE TUNING
# ================================================================
# Prometheus query limits
PROMETHEUS_QUERY_TIMEOUT=2m
PROMETHEUS_QUERY_MAX_SAMPLES=50000000

# Loki query limits
LOKI_QUERY_TIMEOUT=5m
LOKI_MAX_QUERY_LOOKBACK=744h

# Grafana performance
GRAFANA_RENDERING_TIMEOUT=60
GRAFANA_DATAPROXY_TIMEOUT=90

# ================================================================
# SECURITY
# ================================================================
# Basic auth for Prometheus (optional)
# PROMETHEUS_BASIC_AUTH_USER=prometheus
# PROMETHEUS_BASIC_AUTH_PASSWORD=your_prometheus_password

# Basic auth for AlertManager (optional)
# ALERTMANAGER_BASIC_AUTH_USER=alertmanager
# ALERTMANAGER_BASIC_AUTH_PASSWORD=your_alertmanager_password

# ================================================================
# BACKUP & RETENTION
# ================================================================
# Backup configuration (for external backup scripts)
# BACKUP_ENABLED=true
# BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
# BACKUP_RETENTION_DAYS=90
# BACKUP_S3_BUCKET=a4co-observability-backups
# AWS_ACCESS_KEY_ID=your_aws_key
# AWS_SECRET_ACCESS_KEY=your_aws_secret

# ================================================================
# MONITORING THE MONITORING
# ================================================================
# Healthcheck endpoints
HEALTHCHECK_ENABLED=true
HEALTHCHECK_INTERVAL=30s
HEALTHCHECK_TIMEOUT=10s
HEALTHCHECK_RETRIES=3

# ================================================================
# NOTES
# ================================================================
#
# 1. Security: Change all default passwords in production
# 2. Retention: Adjust retention periods based on storage capacity
# 3. Alerting: Configure at least one notification channel
# 4. Backup: Implement regular backups of Prometheus/Grafana data
# 5. Network: Ensure observability stack can reach microservices
# 6. Resources: Monitor resource usage and adjust limits as needed
#
# ================================================================
